<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/dom-ext/lib/document.js - Itsa</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Itsa"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Array.html">Array</a></li>
            
                <li><a href="../classes/document.html">document</a></li>
            
                <li><a href="../classes/Element.html">Element</a></li>
            
                <li><a href="../classes/Event.html">Event</a></li>
            
                <li><a href="../classes/Event.Emitter.html">Event.Emitter</a></li>
            
                <li><a href="../classes/Event.Listener.html">Event.Listener</a></li>
            
                <li><a href="../classes/Function.html">Function</a></li>
            
                <li><a href="../classes/IO.html">IO</a></li>
            
                <li><a href="../classes/ITSA.html">ITSA</a></li>
            
                <li><a href="../classes/NodeList.html">NodeList</a></li>
            
                <li><a href="../classes/Object.html">Object</a></li>
            
                <li><a href="../classes/Promise.html">Promise</a></li>
            
                <li><a href="../classes/String.html">String</a></li>
            
                <li><a href="../classes/Utils.html">Utils</a></li>
            
                <li><a href="../classes/window.html">window</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/dom-ext.html">dom-ext</a></li>
            
                <li><a href="../modules/event.html">event</a></li>
            
                <li><a href="../modules/event-dom.html">event-dom</a></li>
            
                <li><a href="../modules/event-dragdrop.html">event-dragdrop</a></li>
            
                <li><a href="../modules/event-emitter.html">event-emitter</a></li>
            
                <li><a href="../modules/event-hover.html">event-hover</a></li>
            
                <li><a href="../modules/event-listener.html">event-listener</a></li>
            
                <li><a href="../modules/event-mobile.html">event-mobile</a></li>
            
                <li><a href="../modules/io.html">io</a></li>
            
                <li><a href="../modules/io-assets.html">io-assets</a></li>
            
                <li><a href="../modules/io-cors.html">io-cors</a></li>
            
                <li><a href="../modules/io-jsonp.html">io-jsonp</a></li>
            
                <li><a href="../modules/io-transfer.html">io-transfer</a></li>
            
                <li><a href="../modules/io-xml.html">io-xml</a></li>
            
                <li><a href="../modules/itsa.build.html">itsa.build</a></li>
            
                <li><a href="../modules/js-ext.html">js-ext</a></li>
            
                <li><a href="../modules/lib_array.js.html">lib/array.js</a></li>
            
                <li><a href="../modules/lib_document.js.html">lib/document.js</a></li>
            
                <li><a href="../modules/lib_element.js.html">lib/element.js</a></li>
            
                <li><a href="../modules/lib_function.js.html">lib/function.js</a></li>
            
                <li><a href="../modules/lib_nodelist.js.html">lib/nodelist.js</a></li>
            
                <li><a href="../modules/lib_object.js.html">lib/object.js</a></li>
            
                <li><a href="../modules/lib_promise.s.html">lib/promise.s</a></li>
            
                <li><a href="../modules/lib_string.js.html">lib/string.js</a></li>
            
                <li><a href="../modules/node-win.html">node-win</a></li>
            
                <li><a href="../modules/utils.html">utils</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/dom-ext/lib/document.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&quot;use strict&quot;;

/**
 * Integrates DOM-events to event. more about DOM-events:
 * http://www.smashingmagazine.com/2013/11/12/an-introduction-to-dom-events/
 *
 *
 * &lt;i&gt;Copyright (c) 2014 ITSA - https://github.com/itsa&lt;/i&gt;
 * New BSD License - http://choosealicense.com/licenses/bsd-3-clause/
 *
 * @example
 * require(&#x27;dom-ext/lib/document.js&#x27;)(window);
 *
 * @module dom-ext
 * @submodule lib/document.js
 * @class document
 * @since 0.0.1
*/

module.exports = function (window) {
    require(&#x27;polyfill/lib/array.some.js&#x27;);
    require(&#x27;polyfill/lib/array.isarray.js&#x27;);
    require(&#x27;./nodelist.js&#x27;)(window);
    require(&#x27;polyfill/lib/element.matchesselector.js&#x27;)(window);

    var HTML_CHARS = {
        &#x27;&amp;&#x27;: &#x27;&amp;amp;&#x27;,
        &#x27;&lt;&#x27;: &#x27;&amp;lt;&#x27;,
        &#x27;&gt;&#x27;: &#x27;&amp;gt;&#x27;,
        &#x27;&quot;&#x27;: &#x27;&amp;quot;&#x27;,
        &quot;&#x27;&quot;: &#x27;&amp;#x27;&#x27;,
        &#x27;/&#x27;: &#x27;&amp;#x2F;&#x27;,
        &#x27;&#x60;&#x27;: &#x27;&amp;#x60;&#x27;
    },
    DOCUMENT = window.document,
    SINGLE_NODE_ID_REGEXP = /^#\S+$/,

    /**
    @method html
    @param {String} string String to escape.
    @return {String} Escaped string.
    @static
    **/
    escapeHTML = function (content) {
        (content.serialize) &amp;&amp; (content=content.serialize());
        return content.replace(/[&amp;&lt;&gt;&quot;&#x27;\/&#x60;]/g, function (match) {return HTML_CHARS[match];});
    },

    toCamelCase = function(input) {
        return input.toLowerCase().replace(/-(.)/g, function(match, group) {
            return group.toUpperCase();
        });
    },

   /*
    * Creates a fragment out of a String, so that it can be inserted as a NodeList.
    *
    * @method _createFragment
    * @param content {String} content to be fragmented
    * @return {DocumentFragment}
    * @since 0.0.1
    */
    _createFragment = function(content) {
        var fragment = DOCUMENT.createDocumentFragment(),
            cont = DOCUMENT.createElement(&#x27;div&#x27;),
            first;
        cont.innerHTML = content;
/*jshint boss:true */
        while (first=cont.firstChild) {
            fragment.appendChild(first);
        }
/*jshint boss:false */
        return fragment;
    },

   /**
    * Inserts a HtmlElement or text at the specified position.
    *
    * @method _insert
    * @param htmlElement {HtmlElement} the HtmlElement where the action should be applied to
    * @param method {String} method to be used (either &#x60;insertBefore&#x60; or &#x60;appendChild&#x60;)
    * @param content {HtmlElement|HtmlElementList|String} content to append
    * @param refElement {HtmlElement} reference-element in case of &#x60;insertBefore&#x60;
    * @param escape {Boolean} whether to insert &#x60;escaped&#x60; content, leading it into only text inserted
    * @return {HtmlElement} the original HtmlElement so it can be chained
    * @since 0.0.1
    */
    _insert = function(htmlElement, method, content, refElement, escape) {
        var first;
        // cannot check if isArray: NodeList and HTMLCollection are extended with &#x60;forEach()&#x60; but they are no arrays
        if (content.forEach) {
            // carefull: in case of NodeList or HTMLCollection we cannot use &quot;forEach&quot; because the Elements will be
            // removes from the previous hash, making &#x60;forEach&#x60; to creates gaps
            if (escape || Array.isArray(content)) {
                content.forEach(
                    function(element) {
                        escape &amp;&amp; (element=escapeHTML(element));
                        (typeof element === &#x27;string&#x27;) &amp;&amp; (element=_createFragment(element));
                        htmlElement[method](element, refElement);
                    }
                );
            }
            else {
/*jshint boss:true */
                while (first=content[0]) {
                    htmlElement[method](escape ? escapeHTML(first) : first, refElement);
                }
/*jshint boss:false */
            }
        }
        else {
            escape &amp;&amp; (content=escapeHTML(content));
            (typeof content === &#x27;string&#x27;) &amp;&amp; (content=_createFragment(content));
            htmlElement[method](content, refElement);

        }
        return htmlElement;
    };

   /**
    * Returns the first of the HtmlElement&#x27;s siblings, or the first that matches &#x60;cssSelector&#x60;.
    *
    * @method first
    * @param [cssSelector] {String} css-selector to be used as a filter
    * @return {HtmlElement|null}
    * @since 0.0.1
    */
    DOCUMENT.first = function(cssSelector) {
        var parent = this.parentHtmlElement || window.document, // not &#x60;this&#x60; because the context might change
            found;
        if (!cssSelector) {
            return parent.firstElementChild;
        }
        Array.prototype.some.call(parent.children, function(element) {
            element.matchesSelector(cssSelector) &amp;&amp; (found=element);
            return found;
        });
        return found;
    };

   /**
    * Gets a NodeList of HtmlElements, specified by the css-selector.
    *
    * @method getAll
    * @param cssSelector {String} css-selector to match
    * @return {NodeList} NodeList of HtmlElements that match the css-selector
    * @since 0.0.1
    */
    DOCUMENT.getAll = function(cssSelector) {
        try {
            return this.querySelectorAll(cssSelector); // throws an error or falsy selector
        }
        catch (err) {
            return [];
        }
    };

   /**
    * Gets one HtmlElement, specified by the css-selector. To retrieve a single element by id,
    * you need to prepend the id-name with a &#x60;#&#x60;. When multiple HtmlElement&#x27;s match, the first is returned.
    *
    * @method getElement
    * @param cssSelector {String} css-selector to match
    * @return {HtmlElement|null} the HtmlElement that was search for
    * @since 0.0.1
    */
    DOCUMENT.getElement = function(cssSelector) {
        return SINGLE_NODE_ID_REGEXP.test(cssSelector) ? this.getElementById(cssSelector.substr(1)) : this.getAll(cssSelector)[0];
    };

   /**
    * Gets the HtmlElement that currently has the focus.
    * alias for &#x60;activeElement&#x60;
    *
    * @method getFocussed
    * @return {HtmlElement|null} the HtmlElement that has focus
    * @since 0.0.1
    */
    DOCUMENT.getFocussed = function() {
        return this.activeElement;
    };

   /**
    * Inserts a HtmlElement or text inside HtmlElement&#x27;s innerHTML after &#x60;refElement&#x60;.
    *
    * @method insertAfter
    * @param content {HtmlElement|HtmlElementList|String} content to insert
    * @param refElement {HtmlElement} the HtmlElement where the content should be placed after
    * @param [escape] {Boolean} whether to insert &#x60;escaped&#x60; content, leading it into only text inserted
    * @chainable
    * @since 0.0.1
    */
    DOCUMENT.insertAfter = function(content, refElement, escape) {
        var instance = this,
            children = instance.children,
            index = children.indexOf(refElement);
        if ((index==-1) || (index===children.length-1)) {
            return _insert(instance, &#x27;appendChild&#x27;, content, null, escape);
        }
        return _insert(instance, (instance._insertBefore ? &#x27;_&#x27; : &#x27;&#x27;) + &#x27;insertBefore&#x27;, content, children[index+1], escape);
    };

   /**
    * Inserts a HtmlElement or text inside HtmlElement&#x27;s innerHTML before &#x60;refElement&#x60;.
    *
    * @method insertBefore
    * @param content {HtmlElement|HtmlElementList|String} content to insert
    * @param refElement {HtmlElement} the HtmlElement where the content should be placed before
    * @param [escape] {Boolean} whether to insert &#x60;escaped&#x60; content, leading it into only text inserted
    * @chainable
    * @since 0.0.1
    */
    DOCUMENT.insertBefore = function(content, refElement, escape) {
        var instance = this,
            index = instance.children.indexOf(refElement);
        if (index==-1) {
            return _insert(instance, &#x27;appendChild&#x27;, content, null, escape);
        }
        return _insert(instance, (instance._insertBefore ? &#x27;_&#x27; : &#x27;&#x27;) + &#x27;insertBefore&#x27;, content, refElement, escape);
    };

   /**
    * Returns the last of the HtmlElement&#x27;s siblings, or the last that matches &#x60;cssSelector&#x60;.
    *
    * @method last
    * @param [cssSelector] {String} css-selector to be used as a filter
    * @return {HtmlElement|null}
    * @since 0.0.1
    */
    DOCUMENT.last = function(cssSelector) {
        var parent = this.parentHtmlElement || window.document, // not &#x60;this&#x60; because the context might change
            found, i;
        if (!cssSelector) {
            return parent.lastElementChild;
        }
        for (i=parent.children-1; !found &amp;&amp; (i&gt;0); i--) {
            parent.children[i].matchesSelector(cssSelector) &amp;&amp; (found=parent.children[i]);
        }
        return found;
    };

   /**
    * Replaces the HtmlElement with a new HtmlElement.
    *
    * @method replace
    * @param newHtmlElement {HtmlElement|String} the new HtmlElement
    * @param [escape] {Boolean} whether to insert &#x60;escaped&#x60; content, leading it into only text inserted
    * @chainable
    * @since 0.0.1
    */
    DOCUMENT.replace = function(oldHtmlElement, newHtmlElement, escape) {
        var instance = this,
            parentNode = instance.parentNode;
        (typeof newHtmlElement === &#x27;string&#x27;) &amp;&amp; (newHtmlElement=_createFragment(newHtmlElement));
        parentNode.replaceChild(escape ? escapeHTML(newHtmlElement) : newHtmlElement, instance);
        return escape ? parentNode : newHtmlElement;
    };

   /**
    * Tests if the HtmlElement would be selected by the specified cssSelector.
    * Alias for &#x60;matchesSelector()&#x60;
    *
    * @method test
    * @param cssSelector {String} the css-selector to test against
    * @return {Boolean} whether or not the node matches the selector
    * @since 0.0.1
    */
    DOCUMENT.test = function(cssSelector) {
        return this.matchesSelector(cssSelector);
    };

};
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
